<!DOCTYPE html>

<html>
<head>
  <title>inputComponent.ts</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="../chickendodge.html">
                      src/chickendodge.ts
                </a>
              
                
                <a class="source" href="../components.html">
                      src/components.ts
                </a>
              
                
                <a class="source" href="backgroundLoaderComponent.html">
                      src/components/backgroundLoaderComponent.ts
                </a>
              
                
                <a class="source" href="cameraComponent.html">
                      src/components/cameraComponent.ts
                </a>
              
                
                <a class="source" href="chickenComponent.html">
                      src/components/chickenComponent.ts
                </a>
              
                
                <a class="source" href="chickenSpawnerComponent.html">
                      src/components/chickenSpawnerComponent.ts
                </a>
              
                
                <a class="source" href="colliderComponent.html">
                      src/components/colliderComponent.ts
                </a>
              
                
                <a class="source" href="component.html">
                      src/components/component.ts
                </a>
              
                
                <a class="source" href="compositorComponent.html">
                      src/components/compositorComponent.ts
                </a>
              
                
                <a class="source" href="countdownComponent.html">
                      src/components/countdownComponent.ts
                </a>
              
                
                <a class="source" href="debugDrawCallsComponent.html">
                      src/components/debugDrawCallsComponent.ts
                </a>
              
                
                <a class="source" href="deformationCompositorComponent.html">
                      src/components/deformationCompositorComponent.ts
                </a>
              
                
                <a class="source" href="enablerComponent.html">
                      src/components/enablerComponent.ts
                </a>
              
                
                <a class="source" href="heartComponent.html">
                      src/components/heartComponent.ts
                </a>
              
                
                <a class="source" href="inputComponent.html">
                      src/components/inputComponent.ts
                </a>
              
                
                <a class="source" href="layerComponent.html">
                      src/components/layerComponent.ts
                </a>
              
                
                <a class="source" href="lifeComponent.html">
                      src/components/lifeComponent.ts
                </a>
              
                
                <a class="source" href="playerComponent.html">
                      src/components/playerComponent.ts
                </a>
              
                
                <a class="source" href="positionComponent.html">
                      src/components/positionComponent.ts
                </a>
              
                
                <a class="source" href="rawSpriteComponent.html">
                      src/components/rawSpriteComponent.ts
                </a>
              
                
                <a class="source" href="rectangle.html">
                      src/components/rectangle.ts
                </a>
              
                
                <a class="source" href="refereeComponent.html">
                      src/components/refereeComponent.ts
                </a>
              
                
                <a class="source" href="renderCompositorComponent.html">
                      src/components/renderCompositorComponent.ts
                </a>
              
                
                <a class="source" href="rupeeComponent.html">
                      src/components/rupeeComponent.ts
                </a>
              
                
                <a class="source" href="scoreComponent.html">
                      src/components/scoreComponent.ts
                </a>
              
                
                <a class="source" href="spriteComponent.html">
                      src/components/spriteComponent.ts
                </a>
              
                
                <a class="source" href="spriteSheetComponent.html">
                      src/components/spriteSheetComponent.ts
                </a>
              
                
                <a class="source" href="textSpriteComponent.html">
                      src/components/textSpriteComponent.ts
                </a>
              
                
                <a class="source" href="textureComponent.html">
                      src/components/textureComponent.ts
                </a>
              
                
                <a class="source" href="timerComponent.html">
                      src/components/timerComponent.ts
                </a>
              
                
                <a class="source" href="../entity.html">
                      src/entity.ts
                </a>
              
                
                <a class="source" href="../eventTrigger.html">
                      src/eventTrigger.ts
                </a>
              
                
                <a class="source" href="../graphicsAPI.html">
                      src/graphicsAPI.ts
                </a>
              
                
                <a class="source" href="../main.html">
                      src/main.ts
                </a>
              
                
                <a class="source" href="../resources.html">
                      src/resources.ts
                </a>
              
                
                <a class="source" href="../scene.html">
                      src/scene.ts
                </a>
              
                
                <a class="source" href="../systems/displaySystem.html">
                      src/systems/displaySystem.ts
                </a>
              
                
                <a class="source" href="../systems/logicSystem.html">
                      src/systems/logicSystem.ts
                </a>
              
                
                <a class="source" href="../systems/physicSystem.html">
                      src/systems/physicSystem.ts
                </a>
              
                
                <a class="source" href="../systems/system.html">
                      src/systems/system.ts
                </a>
              
                
                <a class="source" href="../timing.html">
                      src/timing.ts
                </a>
              
                
                <a class="source" href="../utils.html">
                      src/utils.ts
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>inputComponent.ts</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> { Component, IComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">"./component"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> IInputComponent <span class="hljs-keyword">extends</span> IComponent {
  isLocal: <span class="hljs-built_in">boolean</span>;
  listSymbols(): <span class="hljs-built_in">string</span>[];
  getKey(symbol: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">boolean</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="interface-ikeypressed-">Interface <em>IKeyPressed</em></h2>
<p>Cette interface permet de définir un type associant une clé
à un type booléen.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">interface</span> IKeyPressed {
  [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">boolean</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="variable-keypressed-">Variable <em>keyPressed</em></h2>
<p>Tableau associatif vide qui contiendra l’état courant
des touches du clavier.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> keyPressed: IKeyPressed = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="m-thode-setupkeyboardhandler-">Méthode <em>setupKeyboardHandler</em></h2>
<p>Cette méthode enregistre des fonctions qui seront
appelées par le navigateur lorsque l’utilisateur appuie
sur des touches du clavier. On enregistre alors si la touche
est appuyée ou relâchée dans le tableau <code>keyPressed</code>.</p>
<p>On utilise la propriété <code>code</code> de l’événement, qui est
indépendant de la langue du clavier (ie.: WASD vs ZQSD)</p>
<p>Cette méthode est appelée lors du chargement de ce module.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupKeyboardHandler</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, <span class="hljs-function">(<span class="hljs-params">evt</span>) =&gt;</span> {
    keyPressed[evt.code] = <span class="hljs-literal">true</span>;
  }, <span class="hljs-literal">false</span>);

  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keyup"</span>, <span class="hljs-function">(<span class="hljs-params">evt</span>) =&gt;</span> {
    keyPressed[evt.code] = <span class="hljs-literal">false</span>;
  }, <span class="hljs-literal">false</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h1 id="composant-inputcomponent-">Composant <em>InputComponent</em></h1>
<p>Ce composant comprend les méthodes nécessaires pour
saisir les entrées de l’utilisateur.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">interface</span> ISymbolMap {
  [action: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">interface</span> IInputComponentDesc {
  symbols: ISymbolMap;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> InputComponent <span class="hljs-keyword">extends</span> Component&lt;IInputComponentDesc&gt; <span class="hljs-keyword">implements</span> IInputComponent {
  <span class="hljs-keyword">public</span> isLocal = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">private</span> symbols!: ISymbolMap;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="m-thode-create-">Méthode <em>create</em></h2>
<p>Cette méthode est appelée pour configurer le composant avant
que tous les composants d’un objet aient été créés.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">public</span> create(descr: IInputComponentDesc) {
    <span class="hljs-keyword">this</span>.symbols = descr.symbols;
  }

  <span class="hljs-keyword">public</span> listSymbols() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>.symbols);
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="fonction-getkey-">Fonction <em>getKey</em></h2>
<p>Cette méthode retourne une valeur correspondant à un symbole défini.</p>
<p>Si on le voulait, on pourrait substituer cette implémentation
par clavier par une implémentation de l’<a href="https://developer.mozilla.org/fr/docs/Web/Guide/API/Gamepad">API Gamepad.</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">public</span> getKey(symbol: <span class="hljs-built_in">string</span>) {
    <span class="hljs-keyword">if</span> (keyPressed[<span class="hljs-keyword">this</span>.symbols[symbol]]) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Configuration de la capture du clavier au chargement du module.
On met dans un bloc <code>try/catch</code> afin de pouvoir exécuter les
tests unitaires en dehors du navigateur.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">try</span> {
  setupKeyboardHandler();
} <span class="hljs-keyword">catch</span> (e) {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Rien</p>

            </div>
            
            <div class="content"><div class='highlight'><pre> }</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
